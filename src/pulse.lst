pulse.lst - generated by MGTEK Assembler ASM11 V1.26 Build 144 for WIN32 (x86) - Mon Dec 01 13:19:03 2025

    1:          =00000000              PRG_START   EQU $0000 ; Internal ROM start
    2:                                 
    3:          =00001000              PORTA       EQU $1000 ; PORTA controls OE'
    4:          =00001004              PORTB       EQU $1004 ; PORTB controls 2764 address lines
    5:          =00001003              PORTC       EQU $1003 ; PORTC receives data from 2764
    6:                                 
    7:          =00000019              PULSE_WIDTH EQU $19
    8:                                 
    9:          =00000000              ADDR        EQU $00  ; Corresponding addresses
   10:          =00000019              NUM_BYTES   EQU 25   ; 0x000 to 0x018
   11:                                 
   12:     0000 +0001                  COUNT       RMB 1    ; Loop counter for bytes
   13:                                 
   14:          =00000000                  ORG PRG_START
   15:     0000 C6 01                              LDAB #1
   16:                                 
   17:                                 ; ------------------------------------------------------------------------------
   18:                                 ; Subroutine PULSE
   19:                                 ; Sends an approx. n-ms pulse at bit 7 of PORTB
   20:                                 ; (6 + (3 + (3 + 3)*332) * n) / 2MHz ~= n*0.9975ms
   21:                                 ;
   22:                                 ; Parameters:
   23:                                 ;   ACCB: Duration of pulse in ms
   24:                                 ; Modifies: ACCA, ACCB, X
   25:                                 ; ------------------------------------------------------------------------------
   26:                                 
   27:     0002 86 80                  PULSE       LDAA #$80
   28:     0004 B7 1004                            STAA PORTB      ; 4 cycles
   29:     0007 8D 09                              BSR DELAY_1MS   ; 6 cycles
   30:     0009 4F                                 CLRA
   31:     000A B7 1004                            STAA PORTB
   32:     000D 8D 03                              BSR DELAY_1MS
   33:     000F 20 F1                              BRA PULSE
   34:     0011 39                                 RTS             ; 5 cycles
   35:                                 
   36:     0012 CE 014C                DELAY_1MS   LDX #332        ; 3 cycles
   37:     0015 09                     DELAY_LOOP  DEX             ; 3 cycles
   38:     0016 26 FD                              BNE DELAY_LOOP  ; 3 cycles
   39:     0018 5A                                 DECB            ; 2 cycles
   40:     0019 26 F7                              BNE DELAY_1MS   ; 3 cycles
   41:     001B 39                                 RTS             ; 5 cycles
   42:                                 
